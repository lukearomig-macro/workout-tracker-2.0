<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<title>Coach Protocol</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
body{background:#080808;color:#F0EDE8;font-family:Georgia,'Times New Roman',serif;min-height:100vh;overflow-x:hidden}
input,button,select,textarea{font-family:Georgia,'Times New Roman',serif;-webkit-appearance:none;appearance:none}
input:focus,select:focus,textarea:focus{outline:none}
::-webkit-scrollbar{width:0px}
@keyframes slideUp{from{transform:translateY(14px);opacity:0}to{transform:translateY(0);opacity:1}}
.ain{animation:slideUp 0.2s ease forwards}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useRef}=React;
const DAYS=[
{id:1,name:"Day 1",label:"PUSH — Heavy Chest + Abs",color:"#FF4D1C",type:"training",exercises:[
{name:"Incline DB Press",sets:4,rr:[6,10],rpe:"8 / last RPE 9",cues:"Bench at 30-45 degrees. Grip just outside shoulder width. Lower DBs to lower chest with elbows at 60 degrees from torso. Press explosively, squeeze at top. Full stretch at bottom."},
{name:"Machine Chest Press",sets:3,rr:[8,12],rpe:"8 / last rest-pause to failure",cues:"Handles at mid-chest. Drive through palms. Last set: go to failure, rack, rest 15s, repeat until you cannot complete a full rep."},
{name:"Low-to-High Cable Fly",sets:3,rr:[12,15],rpe:"9 all sets",cues:"Cables at lowest. Slight forward lean. Arc handles upward and inward above chest. Squeeze hard at top. Control the eccentric."},
{name:"Seated DB Shoulder Press",sets:3,rr:[8,12],rpe:"8 / last RPE 9",cues:"Sit upright. DBs at ear height, elbows slightly in front. Press overhead without locking out. Lower slowly 2-3 seconds."},
{name:"Cable Lateral Raise",sets:4,rr:[12,20],rpe:"9 all sets",cues:"Cable lowest, cross-body grip. Lead with elbow not wrist. Raise to just above shoulder height. Thumb down at top. Slow 3-second negative."},
{name:"Rope Triceps Pushdown",sets:3,rr:[10,15],rpe:"9 all sets",cues:"Elbows pinned to sides, must not move. Split rope at bottom, fully extend. Squeeze hard at full extension. Control the return."},
{name:"Ab Wheel Rollout",sets:4,rr:[6,12],rpe:"8",cues:"From knees until you can maintain neutral spine from toes. Brace hard before moving. Roll only as far as back stays neutral. Pull back through abs not shoulders."},
{name:"Reverse Crunch",sets:4,rr:[10,15],rpe:"8",cues:"Lie flat, hands under glutes. Curl pelvis toward ribcage, small movement. No momentum. Squeeze at top, slow on the way down. Lower back presses into floor throughout."},
{name:"Pallof Press",sets:3,rr:[20,30],rpe:"7",cues:"Cable at chest height, stand sideways. Brace core hard. Press straight out and hold, resist the rotation. Anti-rotation not pressing. Both sides."},
]},
{id:2,name:"Day 2",label:"PULL — Width + Thickness",color:"#0EA5E9",type:"training",exercises:[
{name:"Neutral-Grip Pulldown",sets:4,rr:[8,12],rpe:"8 / last RPE 9",cues:"Palms facing each other. Initiate by depressing shoulder blades, elbows down and back not just down. Lean back slightly. Squeeze lats hard at bottom. Full stretch at top."},
{name:"Chest-Supported Row",sets:4,rr:[8,12],rpe:"8 / last RPE 9",cues:"Chest on pad isolates back. Pull to lower sternum, elbows close to sides. Fully retract and depress shoulder blades at top, 2-second hold. Full stretch at bottom."},
{name:"Barbell or Machine Row",sets:3,rr:[8,10],rpe:"8 / last RPE 9",cues:"Hip hinge, flat back. Pull to lower abdomen, elbows drive back past hips. Heavier movement for mid-back thickness. Control descent. No jerking."},
{name:"Single-Arm Lat Pull-In",sets:3,rr:[10,15],rpe:"9 all sets",cues:"Cable overhead, single handle. Drive elbow down to hip, not pulling with hand. Torso stays still. Full overhead stretch between reps."},
{name:"Reverse Pec Deck",sets:4,rr:[12,20],rpe:"9 all sets",cues:"Chest against pad, arms slightly bent and locked. Lead elbows back and wide. Squeeze rear delts at full extension. Slow 3-second return. No momentum."},
{name:"Incline DB Curl",sets:3,rr:[8,12],rpe:"8 / last RPE 9",cues:"Bench at 45-60 degrees. Arms hang fully behind, pre-stretches long head of bicep. Curl without elbows drifting forward. Supinate wrist as you curl."},
{name:"Cable Curl",sets:2,rr:[12,15],rpe:"9 all sets",cues:"Low cable. Elbows fixed at sides. Full contraction at top, hold and squeeze. Slow 3-second negative. The negative is where growth happens."},
]},
{id:3,name:"Day 3",label:"LEGS — Balanced + Abs",color:"#22C55E",type:"training",exercises:[
{name:"Smith Squat",sets:4,rr:[8,12],rpe:"8 / last RPE 9",cues:"Feet slightly forward, shoulder-width or wider. Sit back and down, chest up, knees track toes. Parallel or below. Drive through whole foot. Brace core hard throughout."},
{name:"Romanian Deadlift",sets:4,rr:[8,12],rpe:"8 / last RPE 9",cues:"Hip hinge not squat. Push hips back, bar close to legs. Feel deep hamstring stretch. Neutral spine throughout. Stop when pelvis starts to tuck."},
{name:"Bulgarian Split Squat",sets:3,rr:[8,12],rpe:"8",cues:"Rear foot elevated. Front foot forward so shin stays vertical at bottom. Lower rear knee toward floor. Load felt in front quad and glute. Torso upright."},
{name:"Leg Extension",sets:3,rr:[12,20],rpe:"9 all sets",cues:"Pad just above ankles. Extend fully, hold contraction at top for a count. Slow 3-second negative. Keep glutes on seat throughout."},
{name:"Lying Leg Curl",sets:3,rr:[10,15],rpe:"9 all sets",cues:"Pad just above heels. Full range, curl heels toward glutes. Squeeze hard at top. Plantarflex feet to increase contraction. Slow negative."},
{name:"Calf Raise",sets:4,rr:[8,12],rpe:"9",cues:"Full stretch at bottom, full contraction at top. Hold top for a full second. No partial reps. Slow 3-second negative."},
{name:"Weighted Floor Crunch",sets:4,rr:[8,12],rpe:"8",cues:"Plate at chest. Only upper back comes off floor, not a sit-up. Hard abs contraction at top. Slow return. Progress the weight over time."},
{name:"Ab Wheel Rollout",sets:3,rr:[6,12],rpe:"8",cues:"Brace hard. Roll only as far as lower back stays neutral. Pull back through abs. Feel it in lower back means range exceeds strength, reduce it."},
{name:"Pallof Press",sets:3,rr:[20,30],rpe:"7",cues:"Cable at chest height, sideways. Brace. Press straight out and hold. Resist rotation. Both sides. Slow and controlled."},
]},
{id:4,name:"Day 4",label:"PUSH — Volume + Shape",color:"#FF4D1C",type:"training",exercises:[
{name:"Incline Smith Press",sets:4,rr:[8,12],rpe:"8 / last RPE 9",cues:"Bench at 30-45 degrees. Slightly wider than shoulder grip. Lower to upper chest, no bounce. Press explosively. Full range."},
{name:"Flat DB Press",sets:3,rr:[8,12],rpe:"8 / last RPE 9",cues:"Flat bench. Elbows at 60-75 degrees from body. Press up and slightly inward. Full stretch at bottom, DBs below bench level. Builds mid-chest mass. Do not substitute."},
{name:"High-to-Low Cable Fly",sets:3,rr:[12,15],rpe:"9 all sets",cues:"Cables at highest position. Arc downward and inward, meeting below chest. Targets lower chest fibers. Squeeze hard at bottom. Control the return."},
{name:"Cable Fly",sets:3,rr:[12,15],rpe:"9 all sets",cues:"Cables at mid height, arms slightly bent and locked. Hug a barrel. Squeeze at peak contraction. Slow 3-second negative. Feel stretch at full extension."},
{name:"DB Lateral Raise",sets:4,rr:[15,25],rpe:"9 all sets",cues:"Slight forward hip lean. Lead with elbows. Raise to just above parallel. Pinky up slightly at top. Slow 3-4 second negative. No swinging."},
{name:"Overhead Triceps Extension",sets:3,rr:[10,15],rpe:"9 all sets",cues:"Elbows at ceiling, must not flare. Full extension overhead, full stretch behind head. Long head of tricep. Slow negative."},
]},
{id:5,name:"Day 5",label:"ARMS + DELTS",color:"#A855F7",type:"training",exercises:[
{name:"Cable Lateral Raise",sets:5,rr:[12,20],rpe:"9 all sets",cues:"Lowest cable, cross-body. Lead with elbow. Just above shoulder height. Thumb down at top. 3-second negative. 5 sets is intentional, delts respond to volume."},
{name:"Face Pull",sets:3,rr:[15,20],rpe:"7 — health only",cues:"Rope at forehead height. Pull to face with elbows high and wide, W shape. External rotation at end. Never go heavy. Light weight full range. Shoulder health work. Non-negotiable for longevity."},
{name:"EZ-Bar Curl",sets:4,rr:[8,12],rpe:"8 / last RPE 9",cues:"Elbows at sides, must not drift forward. Full range. Supinate at top. Slow 3-second negative. No swinging."},
{name:"Dip Machine",sets:4,rr:[8,12],rpe:"8 / last RPE 9",cues:"Stay upright to bias triceps. Full extension at bottom, do not lock out at top. Slow negative. Primary tricep mass builder today."},
{name:"Hammer Curl",sets:3,rr:[10,15],rpe:"9 all sets",cues:"Neutral grip throughout. Targets brachialis and brachioradialis, key for arm thickness. Elbows at sides. Full range."},
{name:"Rear-Delt Cable Fly",sets:4,rr:[15,20],rpe:"9 all sets",cues:"Cables crossed, cross-body grip. Arms slightly bent, locked. Elbows wide and back. Full range. Squeeze rear delts at full extension. Slow return."},
]},
{id:6,name:"Day 6",label:"REST / Recovery",color:"#64748B",type:"rest",exercises:[]},
];
const DELOAD_EVERY=5;
const PROTEIN_TARGET=185;
const CAL_FLOORS={training:2700,rest:2300};
const FOODS=[
{name:"Chicken breast (4oz)",cal:185,pro:35,carb:0,fat:4},
{name:"Ground beef 90pct (4oz)",cal:200,pro:24,carb:0,fat:11},
{name:"Salmon (4oz)",cal:234,pro:25,carb:0,fat:14},
{name:"Eggs (2 large)",cal:140,pro:12,carb:1,fat:10},
{name:"Greek yogurt (1 cup)",cal:130,pro:22,carb:8,fat:0},
{name:"Cottage cheese (1 cup)",cal:206,pro:28,carb:8,fat:5},
{name:"Whey protein (1 scoop)",cal:130,pro:25,carb:3,fat:2},
{name:"Oats (1 cup dry)",cal:307,pro:11,carb:55,fat:5},
{name:"White rice (1 cup cooked)",cal:206,pro:4,carb:45,fat:0},
{name:"Banana (medium)",cal:105,pro:1,carb:27,fat:0},
{name:"Sweet potato (medium)",cal:103,pro:2,carb:24,fat:0},
{name:"Bread (2 slices)",cal:160,pro:6,carb:30,fat:2},
{name:"Pasta (2oz dry)",cal:200,pro:7,carb:42,fat:1},
{name:"Avocado (half)",cal:120,pro:1,carb:6,fat:11},
{name:"Olive oil (1 tbsp)",cal:120,pro:0,carb:0,fat:14},
{name:"Mixed nuts (1oz)",cal:172,pro:5,carb:6,fat:15},
{name:"Milk (1 cup)",cal:149,pro:8,carb:12,fat:8},
{name:"Steak (4oz)",cal:280,pro:28,carb:0,fat:18},
{name:"Tuna can (3oz)",cal:100,pro:22,carb:0,fat:1},
{name:"Peanut butter (2 tbsp)",cal:190,pro:8,carb:6,fat:16},
{name:"Apple (medium)",cal:95,pro:0,carb:25,fat:0},
{name:"Protein bar",cal:200,pro:20,carb:22,fat:6},
{name:"Honey (1 tbsp)",cal:64,pro:0,carb:17,fat:0},
{name:"Cheese (1oz)",cal:113,pro:7,carb:0,fat:9},
{name:"Collagen peptides (1 scoop)",cal:35,pro:9,carb:0,fat:0},
];
function todayStr(){return new Date().toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});}
function todayKey(){const d=new Date();return d.getFullYear()+"-"+d.getMonth()+"-"+d.getDate();}
function loadData(){try{return JSON.parse(localStorage.getItem("cp_v4"))||{sessions:[],weightLog:[],nutritionLog:[],weekCount:1,sessionCount:0};}catch{return{sessions:[],weightLog:[],nutritionLog:[],weekCount:1,sessionCount:0};}}
function checkProg(sessions,exName,rr){
  const rel=sessions.filter(s=>s.entries&&s.entries.some(e=>e.exerciseName===exName)).slice(-2);
  if(rel.length<2)return null;
  const hitTop=rel.every(s=>{const e=s.entries.find(e=>e.exerciseName===exName);return e&&e.sets.filter(s=>s.reps).every(set=>parseInt(set.reps)>=rr[1]);});
  if(!hitTop)return null;
  const le=rel[1].entries.find(e=>e.exerciseName===exName);
  return le&&le.sets&&le.sets[0]?le.sets[0].weight||"BW":null;
}
function getTrend(log){const l=log.slice(-7);if(l.length<3)return null;return l[l.length-1].weight-l[0].weight;}
function Stopwatch(){
  const[running,setRunning]=useState(false);
  const[elapsed,setElapsed]=useState(0);
  const ref=useRef(null);
  useEffect(()=>{if(running){ref.current=setInterval(()=>setElapsed(e=>e+1),1000);}else clearInterval(ref.current);return()=>clearInterval(ref.current);},[running]);
  const m=Math.floor(elapsed/60),s=elapsed%60;
  function toggle(){if(running){setRunning(false);setElapsed(0);}else{setElapsed(0);setRunning(true);}}
  return(
    <div style={{display:"flex",alignItems:"center",gap:10,background:"#111",border:"1px solid #2A2A2A",borderRadius:10,padding:"10px 16px",marginBottom:16}}>
      <div style={{fontSize:10,letterSpacing:2,color:"#555",textTransform:"uppercase",flex:1}}>Rest Timer</div>
      <div style={{fontSize:22,fontWeight:"bold",color:running?"#22C55E":"#555",minWidth:56,textAlign:"center"}}>{m}:{String(s).padStart(2,"0")}</div>
      <button onClick={toggle} style={{background:running?"#0A2A0A":"#1A1A1A",border:"1px solid "+(running?"#22C55E":"#2A2A2A"),borderRadius:8,padding:"7px 16px",color:running?"#22C55E":"#888",fontSize:11,letterSpacing:2,textTransform:"uppercase",cursor:"pointer",fontFamily:"inherit"}}>{running?"Stop":"Start"}</button>
    </div>
  );
}
function ResetBtn({onReset}){
  const[c,setC]=useState(false);
  if(!c)return<button onClick={()=>setC(true)} style={{width:"100%",background:"none",border:"1px solid #1A1A1A",color:"#333",padding:"10px 0",borderRadius:10,fontSize:11,letterSpacing:2,textTransform:"uppercase",cursor:"pointer",fontFamily:"inherit",marginTop:16}}>Reset All Data</button>;
  return(
    <div style={{marginTop:16,background:"#1A0808",border:"1px solid #3A1A1A",borderRadius:10,padding:16,textAlign:"center"}}>
      <div style={{fontSize:13,color:"#CC3311",marginBottom:12}}>Delete all data? Cannot be undone.</div>
      <div style={{display:"flex",gap:10}}>
        <button onClick={()=>setC(false)} style={{flex:1,background:"none",border:"1px solid #2A2A2A",color:"#888",padding:"10px 0",borderRadius:8,fontSize:12,cursor:"pointer",fontFamily:"inherit"}}>Keep Data</button>
        <button onClick={()=>{onReset();setC(false);}} style={{flex:1,background:"#CC3311",border:"none",color:"#fff",padding:"10px 0",borderRadius:8,fontSize:12,cursor:"pointer",fontFamily:"inherit"}}>Yes Delete</button>
      </div>
    </div>
  );
}
function HistoryCard({session,day,onUpdate}){
  const[open,setOpen]=useState(false);
  const[editing,setEditing]=useState(false);
  const[ed,setEd]=useState(null);
  function startEdit(){setEd(JSON.parse(JSON.stringify(session)));setEditing(true);}
  function updSet(ei,si,field,val){setEd(prev=>({...prev,entries:prev.entries.map((e,i)=>i!==ei?e:{...e,sets:e.sets.map((s,j)=>j!==si?s:{...s,[field]:val})})}));}
  if(editing&&ed)return(
    <div style={{border:"1px solid #FF4D1C",borderRadius:12,marginBottom:10,background:"#0D0D0D",padding:16}}>
      <div style={{fontSize:10,letterSpacing:3,color:"#FF4D1C",textTransform:"uppercase",marginBottom:12}}>Editing - {session.date}</div>
      {ed.entries&&ed.entries.map((entry,ei)=>(
        <div key={ei} style={{marginBottom:16}}>
          <div style={{fontSize:12,color:"#888",marginBottom:8}}>{entry.exerciseName}</div>
          {entry.sets.map((s,si)=>(
            <div key={si} style={{display:"flex",gap:6,marginBottom:6}}>
              <input value={s.weight||""} onChange={e=>updSet(ei,si,"weight",e.target.value)} placeholder="lbs" inputMode="decimal" style={{flex:1,background:"#111",border:"1px solid #2A2A2A",borderRadius:6,padding:"8px",color:"#F0EDE8",fontSize:14,fontFamily:"inherit",textAlign:"center"}}/>
              <input value={s.reps||""} onChange={e=>updSet(ei,si,"reps",e.target.value)} placeholder="reps" inputMode="numeric" style={{flex:1,background:"#111",border:"1px solid #2A2A2A",borderRadius:6,padding:"8px",color:"#F0EDE8",fontSize:14,fontFamily:"inherit",textAlign:"center"}}/>
              <input value={s.rpe||""} onChange={e=>updSet(ei,si,"rpe",e.target.value)} placeholder="RPE" inputMode="decimal" style={{width:56,background:"#111",border:"1px solid #2A2A2A",borderRadius:6,padding:"8px",color:"#F0EDE8",fontSize:14,fontFamily:"inherit",textAlign:"center"}}/>
            </div>
          ))}
        </div>
      ))}
      <div style={{display:"flex",gap:10,marginTop:8}}>
        <button onClick={()=>setEditing(false)} style={{flex:1,background:"none",border:"1px solid #2A2A2A",color:"#888",padding:"10px 0",borderRadius:8,fontSize:12,cursor:"pointer",fontFamily:"inherit"}}>Cancel</button>
        <button onClick={()=>{onUpdate(ed);setEditing(false);}} style={{flex:2,background:"#22C55E",border:"none",color:"#fff",padding:"10px 0",borderRadius:8,fontSize:12,cursor:"pointer",fontFamily:"inherit"}}>Save Changes</button>
      </div>
    </div>
  );
  return(
    <div style={{border:"1px solid #1E1E1E",borderRadius:12,marginBottom:10,overflow:"hidden",background:"#0D0D0D"}}>
      <div onClick={()=>setOpen(!open)} style={{padding:"14px 16px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"}}>
        <div>
          <div style={{fontSize:10,letterSpacing:3,color:day?day.color:"#555",textTransform:"uppercase",marginBottom:3}}>{session.date}</div>
          <div style={{fontSize:15}}>{session.type==="rest"?(session.restType||"Rest Day"):(day?day.label:"Training")}</div>
        </div>
        <div style={{color:"#333",fontSize:20}}>{open?"-":"+"}</div>
      </div>
      {open&&(
        <div style={{padding:"0 16px 16px",borderTop:"1px solid #1A1A1A"}}>
          {session.type==="rest"?(
            <div style={{paddingTop:12,fontSize:13,color:"#555"}}>{session.notes||"No notes."}</div>
          ):(
            <div>
              {session.entries&&session.entries.map((entry,i)=>(
                <div key={i} style={{marginBottom:14,paddingTop:i===0?14:0}}>
                  <div style={{fontSize:12,color:"#888",marginBottom:8}}>{entry.exerciseName}</div>
                  <div style={{display:"flex",flexWrap:"wrap",gap:6}}>
                    {entry.sets.map((s,si)=>(
                      <div key={si} style={{background:"#111",borderRadius:8,padding:"5px 10px",fontSize:12,color:"#666"}}>
                        {s.weight?s.weight+"lb":"BW"} x {s.reps} {s.rpe?"@"+s.rpe:""}
                      </div>
                    ))}
                  </div>
                </div>
              ))}
              <button onClick={startEdit} style={{marginTop:8,background:"none",border:"1px solid #2A2A2A",color:"#888",padding:"8px 16px",borderRadius:8,fontSize:11,letterSpacing:2,textTransform:"uppercase",cursor:"pointer",fontFamily:"inherit"}}>Edit Session</button>
            </div>
          )}
        </div>
      )}
    </div>
  );
}
function NutritionView({data,setData}){
  const[sel,setSel]=useState("");
  const[showC,setShowC]=useState(false);
  const[cn,s
